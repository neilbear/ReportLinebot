<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <title>ç·šä¸Šé»é¤</title>
    <link rel="stylesheet" href="/static/order.css">
    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
    <style>
        /* æ–°å¢æ¨£å¼è®“è¨‚å–®çµæœæ›´é†’ç›® */
        .order-success {
            background: linear-gradient(135deg, #e8f5e8, #f0f8f0);
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 25px;
            margin: 20px auto;
            text-align: center;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.2);
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .success-icon {
            font-size: 48px;
            margin-bottom: 15px;
            animation: bounce 1s ease-in-out;
            display: block;
        }

        @keyframes bounce {

            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0);
            }

            40% {
                transform: translateY(-10px);
            }

            60% {
                transform: translateY(-5px);
            }
        }

        .success-message {
            font-size: 24px;
            font-weight: bold;
            color: #2E7D32;
            margin-bottom: 20px;
            text-align: center;
        }

        .order-id-container {
            background: #FFF3E0;
            border: 2px solid #FF9800;
            border-radius: 10px;
            padding: 15px;
            margin: 15px auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-width: 150px;
        }

        .order-id-label {
            font-size: 16px;
            color: #E65100;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            text-align: center;
        }

        .order-id-number {
            font-size: 32px;
            font-weight: bold;
            color: #FF6F00;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .total-info {
            background: #F3E5F5;
            border: 2px solid #9C27B0;
            border-radius: 10px;
            padding: 20px;
            margin: 20px auto;
            font-size: 18px;
            text-align: center;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .original-total {
            color: #666;
            margin-bottom: 8px;
            font-size: 16px;
            text-align: center;
        }

        .discount {
            color: #E91E63;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 18px;
            text-align: center;
        }

        .final-total {
            color: #1976D2;
            font-weight: bold;
            font-size: 24px;
            margin-bottom: 15px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .checkout-notice {
            background: #FFEB3B;
            color: #F57F17;
            font-weight: bold;
            padding: 12px;
            border-radius: 8px;
            font-size: 18px;
            border: 2px solid #FBC02D;
            animation: pulse 2s infinite;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.02);
            }

            100% {
                transform: scale(1);
            }
        }

        /* ç¢ºä¿æ•´å€‹çµæœå€åŸŸç½®ä¸­ */
        #result {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin: 20px 0;
        }

        /* æ”¹å–„ç¸½é‡‘é¡é¡¯ç¤ºå€åŸŸ */
        #total-section {
            background: #E3F2FD;
            border: 2px solid #2196F3;
            border-radius: 10px;
            padding: 15px;
            margin: 20px auto;
            text-align: center;
            max-width: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #total-amount {
            font-size: 24px;
            font-weight: bold;
            color: #1565C0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
    </style>
</head>

<body>
    <h2>è«‹é¸æ“‡é¤é»</h2>

    <!-- é¡åˆ¥é¸æ“‡å€åŸŸ -->
    <div id="category-filter">
        <div class="filter-title">é¸æ“‡é¡åˆ¥ï¼š</div>
        <div class="filter-buttons">
            <button type="button" class="filter-btn active" data-category="all">å…¨éƒ¨</button>
            <button type="button" class="filter-btn" data-category="ä¸»é¤é¡">ä¸»é¤é¡</button>
            <button type="button" class="filter-btn" data-category="é»å¿ƒé¡">é»å¿ƒé¡</button>
            <button type="button" class="filter-btn" data-category="è›‹é¤…é¡">è›‹é¤…é¡</button>
            <button type="button" class="filter-btn" data-category="é£²æ–™é¡">é£²æ–™é¡</button>
        </div>
    </div>

    <form id="orderForm">
        <div id="menu-list">
            <div class="menu-category-section" data-category="ä¸»é¤é¡">
                <div class="menu-category">ä¸»é¤é¡</div>
                <div class="category-items">
                    <div class="menu-item">
                        <img src="/static/hamburger.jpg" alt="æ¼¢å ¡" width="60">
                        <div class="item-info">
                            <span class="item-name">æ¼¢å ¡</span>
                            <span class="item-price">$80</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="æ¼¢å ¡" data-price="80" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/hamburger.jpg" alt="èµ·å¸è±¬æ’æ¼¢å ¡" width="60">
                        <div class="item-info">
                            <span class="item-name">èµ·å¸è±¬æ’æ¼¢å ¡</span>
                            <span class="item-price">$100</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="èµ·å¸è±¬æ’æ¼¢å ¡" data-price="100" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/noodle.jpg" alt="éµæ¿éºµ" width="60">
                        <div class="item-info">
                            <span class="item-name">éµæ¿éºµ</span>
                            <span class="item-price">$75</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="éµæ¿éºµ" data-price="75" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/Pot_Burn_Noodles.jpg" alt="é‹ç‡’æ„éºµ" width="60">
                        <div class="item-info">
                            <span class="item-name">é‹ç‡’æ„éºµ</span>
                            <span class="item-price">$95</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="é‹ç‡’æ„éºµ" data-price="95" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="menu-category-section" data-category="é»å¿ƒé¡">
                <div class="menu-category">é»å¿ƒé¡</div>
                <div class="category-items">
                    <div class="menu-item">
                        <img src="/static/french_fries.jpg" alt="è–¯æ¢" width="60">
                        <div class="item-info">
                            <span class="item-name">è–¯æ¢</span>
                            <span class="item-price">$40</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="è–¯æ¢" data-price="40" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/onion_ring.jpg" alt="æ´‹è”¥åœˆ" width="60">
                        <div class="item-info">
                            <span class="item-name">æ´‹è”¥åœˆ</span>
                            <span class="item-price">$50</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="æ´‹è”¥åœˆ" data-price="50" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/hotdog.jpg" alt="ç†±ç‹—" width="60">
                        <div class="item-info">
                            <span class="item-name">ç†±ç‹—</span>
                            <span class="item-price">$35</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="ç†±ç‹—" data-price="35" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/hash_brown.jpg" alt="è–¯é¤…" width="60">
                        <div class="item-info">
                            <span class="item-name">è–¯é¤…</span>
                            <span class="item-price">$35</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="è–¯é¤…" data-price="35" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="menu-category-section" data-category="è›‹é¤…é¡">
                <div class="menu-category">è›‹é¤…é¡</div>
                <div class="category-items">
                    <div class="menu-item">
                        <img src="/static/Chinese omelet.jpg" alt="åŸå‘³è›‹é¤…" width="60">
                        <div class="item-info">
                            <span class="item-name">åŸå‘³è›‹é¤…</span>
                            <span class="item-price">$30</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="åŸå‘³è›‹é¤…" data-price="30" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/corn_kernel.jpg" alt="ç‰ç±³è›‹é¤…" width="60">
                        <div class="item-info">
                            <span class="item-name">ç‰ç±³è›‹é¤…</span>
                            <span class="item-price">$35</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="ç‰ç±³è›‹é¤…" data-price="35" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/hotdog_chinese_omelet.jpg" alt="ç†±ç‹—è›‹é¤…" width="60">
                        <div class="item-info">
                            <span class="item-name">ç†±ç‹—è›‹é¤…</span>
                            <span class="item-price">$45</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="ç†±ç‹—è›‹é¤…" data-price="45" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                </div>
                <div class="menu-item">
                    <img src="/static/ham.jpg" alt="ç†±ç‹—è›‹é¤…" width="60">
                    <div class="item-info">
                        <span class="item-name">ç«è…¿è›‹é¤…</span>
                        <span class="item-price">$55</span>
                        <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="ç«è…¿è›‹é¤…" data-price="55" min="0"
                                value="0"></label>
                    </div>
                </div>
                </div>
            </div>

            <div class="menu-category-section" data-category="é£²æ–™é¡">
                <div class="menu-category">é£²æ–™é¡</div>
                <div class="category-items">
                    <div class="menu-item">
                        <img src="/static/blacktea.jpg" alt="ç´…èŒ¶" width="60">
                        <div class="item-info">
                            <span class="item-name">ç´…èŒ¶</span>
                            <span class="item-price">$25</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="ç´…èŒ¶" data-price="25" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/soy_milk.jpg" alt="è±†æ¼¿" width="60">
                        <div class="item-info">
                            <span class="item-name">è±†æ¼¿</span>
                            <span class="item-price">$20</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="è±†æ¼¿" data-price="20" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="/static/milktea.jpg" alt="å¥¶èŒ¶" width="60">
                        <div class="item-info">
                            <span class="item-name">å¥¶èŒ¶</span>
                            <span class="item-price">$35</span>
                            <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="å¥¶èŒ¶" data-price="35" min="0"
                                    value="0"></label>
                        </div>
                    </div>
                </div>
                <div class="menu-item">
                    <img src="/static/tea.jpg" alt="ç¶ èŒ¶" width="60">
                    <div class="item-info">
                        <span class="item-name">ç¶ èŒ¶</span>
                        <span class="item-price">$25</span>
                        <label>æ•¸é‡ï¼š<input type="number" name="quantity" data-item="ç¶ èŒ¶" data-price="25" min="0"
                                value="0"></label>
                    </div>
                </div>
                </div>
            </div>
        </div>

        <!-- æ”¹å–„çš„ç¸½é‡‘é¡é¡¯ç¤ºå€åŸŸ -->
        <div id="total-section">
            <div id="total-amount">ç¸½é‡‘é¡ï¼š$0</div>
        </div>

        <button type="submit">é€å‡ºè¨‚å–®</button>
    </form>
    <div id="result"></div>
    <script>
        // è¨ˆç®—ç¸½é‡‘é¡çš„å‡½æ•¸
        function calculateTotal() {
            let total = 0;
            document.querySelectorAll('input[name="quantity"]').forEach(input => {
                const quantity = parseInt(input.value) || 0;
                const price = parseInt(input.getAttribute('data-price')) || 0;
                total += quantity * price;
            });
            document.getElementById('total-amount').textContent = `ç¸½é‡‘é¡ï¼š$${total}`;
            return total;
        }

        // ç›£è½æ•¸é‡è®ŠåŒ–
        document.querySelectorAll('input[name="quantity"]').forEach(input => {
            input.addEventListener('input', calculateTotal);
        });

        // é¡åˆ¥ç¯©é¸åŠŸèƒ½
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                const selectedCategory = this.getAttribute('data-category');
                const allSections = document.querySelectorAll('.menu-category-section');

                if (selectedCategory === 'all') {
                    allSections.forEach(section => {
                        section.style.display = 'block';
                    });
                } else {
                    allSections.forEach(section => {
                        if (section.getAttribute('data-category') === selectedCategory) {
                            section.style.display = 'block';
                        } else {
                            section.style.display = 'none';
                        }
                    });
                }
            });
        });

        // è¡¨å–®æäº¤åŠŸèƒ½ï¼ˆä¿®æ”¹çµæœé¡¯ç¤ºéƒ¨åˆ†ï¼‰
        document.getElementById('orderForm').onsubmit = async function (e) {
            e.preventDefault();
            const items = [];
            let totalAmount = 0;

            document.querySelectorAll('input[name="quantity"]').forEach(input => {
                const quantity = parseInt(input.value);
                const itemName = input.getAttribute('data-item');
                const price = parseInt(input.getAttribute('data-price'));
                if (quantity > 0) {
                    items.push({ name: itemName, quantity, price });
                    totalAmount += quantity * price;
                }
            });

            if (items.length === 0) {
                document.getElementById('result').innerHTML = '<div style="color: red; font-weight: bold; text-align: center; padding: 20px;">è«‹è‡³å°‘é¸æ“‡ä¸€é …é¤é»</div>';
                return;
            }

            const data = { user_id: 'guest', items, total_amount: totalAmount };

            const res = await fetch('/order', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                    // ... existing code ...
                },
                body: JSON.stringify(data)
            });

            const result = await res.json();

            // æ”¹å–„çš„è¨‚å–®çµæœé¡¯ç¤º
            let resultHTML = '<div class="order-success">';
            resultHTML += '<div class="success-icon">âœ…</div>';
            resultHTML += '<div class="success-message">æ‚¨çš„è¨‚å–®å·²é€å‡ºï¼</div>';
            resultHTML += '<div class="order-id-container">';
            resultHTML += '<span class="order-id-label">è¨‚å–®ç·¨è™Ÿ</span>';
            resultHTML += '<span class="order-id-number">' + result.order_id + '</span>';
            resultHTML += '</div>';
            resultHTML += '<div class="total-info">';
            resultHTML += '<div class="original-total">åŸåƒ¹ï¼š$' + result.original_total + '</div>';

            if (result.discount > 0) {
                resultHTML += '<div class="discount">ğŸ‰ å„ªæƒ æŠ˜æ‰£ï¼š-$' + result.discount + '</div>';
            }

            resultHTML += '<div class="final-total">ğŸ’° æ‡‰ä»˜é‡‘é¡ï¼š$' + result.final_total + '</div>';
            resultHTML += '<div class="checkout-notice">ğŸª è«‹è‡³æ«ƒå°çµå¸³</div>';
            resultHTML += '</div>';
            resultHTML += '</div>';

            document.getElementById('result').innerHTML = resultHTML;

            // æ»¾å‹•åˆ°çµæœå€åŸŸ
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        };
    </script>
</body>

</html>